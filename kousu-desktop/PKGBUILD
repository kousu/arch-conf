pkgname=kousu-desktop
pkgdesc="Configuration management common to kousu's workstations"

# load common settings; be aware if you ever split up this repo.
[ -f ../lib/lib.PKGBUILD ] && cp -lf ../lib/lib.PKGBUILD .lib.PKGBUILD
. .lib.PKGBUILD || exit 1

depends=(
  kousu-base

  iwd # wifi
  #macchanger # not needed if using iwd's AddressRandomization
  openconnect  # VPN

  alsa-utils

  bluez-utils  # also pulls in the rest of bluetooth # XXX do I need to add `systemctl enable --now bluetooth` somewhere?
  pipewire-pulse
  pipewire-alsa

  yubikey-manager

  # CLI
  pass # password manager
  pass-otp
  xkcdpass    # password generator
  words       # needed for xkcdpass
  pwgen # alternate password generator

  # CLI :: Programming
  helix
  # tree-sitter  # TODO: install and configure this
  android-tools # adb! fastest way to get files in and out of a phone
  android-udev
  tokei    # lines-of-code metrics
  #jad

  # decompiler
  #rizin
  #rz-ghidra
  #dotpeek

  # TUI
  ranger # curses file browser
  #lynx, or elinks, links, w3m # terminal browser

  # GUI
  #xorg-xinit # weirdly you can install X without xorg-xinit on Arch; I guess because lightdm/gdm/etc can serve its purpose?
  #xorg-server # weirdly, xorg-xinit doesn't pull this in; you'd think it would.
  #xorg-xhost
  xorg-xmodmap
  xorg-xkill
  xorg-xev
  xorg-fonts-100dpi
  xorg-fonts-75dpi
  noto-fonts-emoji # Google's Android emoji fonts, with the colourful faces and whatnot
  otf-fira-sans
  ttf-fira-code
  otf-codenewroman-nerd
  ttf-inconsolata-go-nerd
  terminus-font

  # lightdm ?
  xclip
  #peek  # screen recorder (unmaintained. but it is sooo user friendly)

  decoder # QR codes

  ## GUI :: Hardware
  wireshark-qt

  ## GUI :: Desktop Environment
  gvfs
  gvfs-smb
  gvfs-mtp

  ## GUI :: Editors
  #libreoffice-fresh # documents/spreadsheets/presentations/etc
  xournalpp   # PDF editor; mostly good for signing legal documents.
  #qpdf       # another PDF editor, less tools but more accurate
  obsidian    # Notebook
  # zettlr    # alternative notebook (obsidian is more popular and has lots of plugins)

  ## GUI :: Programming
  #vscode
  # TODO: there's typst, rust, go and javascript plugins that need packages
  gource   # https://gource.io, git commit visualization! Kind of unnecessary, but it's small and cool :)

  ## GUI :: Math
  #graphs  # like MacOS's Grapher.app

  ## GUI :: Web
  firefox
  firefox-decentraleyes
  firefox-extension-passff
  firefox-ublock-origin
  # XXX there's now also extra/ublock-origin?
  #chromium # very, very large

  ## GUI :: Comms
  dino
  gajim  # duplicates dino, but is both more annoying and more featureful so I keep it around
  signal-desktop

  ## GUI :: Media
  kousu-media

  ## Games
  #xboard
  #gnuchess  # "optional" for xboard, but not really: it's the AI to play against
  #openra
  #endless-sky
  #kgeography
)

optdepends=(
  # gnome-circle: like suckless.org but for Gnome; people with vision
  'apostrophe: .md focus mode editor; BEWARE: pulls in pandoc which pulls in almost all of haskell'
  #'bustle: DBUS microservice request debugger'  # kousu-dev ??
  'graphs: Graphing calculator'
  'warp: File transfer (magic-wormhole GUI)'
  "podcasts: GNOME's podcatcher"

  # AUR:
  "firefox-extension-privacybadger: [aur] EFF's anti-tracker tool; complements (perhaps redundant to?) uBlock Origin"
  'firefox-clearurls: [aur] remove tracker tokens from links'
  'hollywood: [aur] "hacking"'
  'ttf-ms-fonts: [aur] microsoft fonts; needed to render Word-generated PDFs in Firefox'
  #'ttf-ms-win11-auto: [aur] modern Microsoft fonts' # but more expensive to install; there's some complicated extra step needed?
  'softu2f-git: [aur] virtual YubiKey'
)

package() {
  _package

  chmod 750 "${pkgdir}"/etc/sudoers.d
  chmod 600 "${pkgdir}"/etc/sudoers.d/*
}

# To control GTK/GNOME settings:
# - 'dconf' or 'gconf' (why are there two? who knows)
# To control Firefox settings:
# - Firefox defaults javascripts; plus extra Firefox extensions
# To control xsession settings:
# - if you're using sx, or xinit, or ...whazzit ~/.xsession
#
# In general, if you can't figure it out how to write a config file for a given app, you can do:
#   1. cp -r ~/.config A
#   1. make the change in the app's settings/GUI
#   2. cp -r ~/.config B
#   3. diff -ru A/ B/
# This should identify the change.
# Some apps don't use ~/.config, but they're getting rarer.
