pkgname=kousu-device-allium
pkgdesc="Configuration management for kousu's \"allium\" laptop"
arch=('any')
url="https://github.com/kousu/arch-conf"
#license=("MIT") # there..is no license? not really?

_pkgver() {
  [ -r "$startdir"/.pkgver ] && cat "$startdir"/.pkgver || (echo "r$(git rev-list --count HEAD).commit=$(git describe --always --dirty | sed s/-/+/g)")
}
pkgver="$(_pkgver)"
pkgrel=1

depends=(
  linux-firmware-intel
  kousu-desktop-gnome

  pkgstats  # opt-in to ArchLinux telemetry

  # power management:
  # (using power-profiles-daemon via GNOME for now; but I should explore these)
  #tlp
  #tlpui
  #laptop-mode-tools # TODO: AUR; https://wiki.archlinux.org/title/Laptop_Mode_Tools
  #acpid # TODO: https://wiki.archlinux.org/title/Acpid
  # TODO: https://wiki.archlinux.org/title/CPU_frequency_scaling

  kousu-work
  kousu-art-graphics

  # Programming
  julia
  octave

  waydroid
  #waydroid-image-gapps # AUR
  python-pyclip   # Waydroid clipboard sharing
)

conflicts=(kousu-device-bomp kousu-device-nigiri)

backup=(
  # user-changeable config files
  etc/mkinitcpio.d/linux.preset
)

package() {
  cd "${startdir}/src/"   # instead of prepare() { cp "${startdir}/src/." "${srcdir}" }

  cp -rp * "${pkgdir}"
}
